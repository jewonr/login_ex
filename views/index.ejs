<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer"/>
    <link rel="stylesheet" href="index.css" type="text/css">
    <title>Document</title>
</head>
<body>
    <%-include('header.ejs') %>
    <div class="section_wrapper">   
        <div class="title_wrapper">
            <div id="dec">내가 버린 쓰레기의 양은</div>
            <div id="title">000 kg</div>
        </div>
        <div class="title_wrapper">
            <div id="dec">내가 쓴 돈은</div>
            <div id="title">000 ₩</div>
        </div>
        <div class="title_wrapper">
            <div id="dec">넓어진 쓰레기 섬의 면적은</div>
            <div id="title">000 km²</div>
        </div>
    </div>
    <h1>Hi <%= name %></h1>
    <form action="/logout?_method=DELETE" method="POST">
        <button type="submit">Log Out</button>
    </form>
    <div class="wave" id="wave1"></div>
    <div class="wave" id="wave2"></div>
    <div class="wave" id="wave3"></div>
    <div class="wave" id="wave4"></div>
    <div class="wave" id="wave5"></div>
    <div class="section" id="section1">
        <div class="content_wrapper">
            <h4>6/11</h4>
            <div class="content">
                <p>물품 이름</p>
                <p>1000₩</p>
            </div>
            <div class="content">
                <p></p>
                <p></p>
            </div>
            <div class="content">
                <p></p>
                <p></p>
            </div>
        </div>
        <div class="content_wrapper"></div>
        <div class="content_wrapper"></div>
        <div class="content_wrapper"></div>
    </div>
    <div class="section" id="section2">
        <div class="button_wrapper">
            <div class="option_button">
                <button class="plastic" id="can">캔</button>
                <button class="plastic" id="bottle">페트병</button>
                <button class="plastic" id="bag">비닐봉지</button>
                <button class="plastic" id="cup">페트컵</button>
                <button class="plastic" id="snack">과자봉지</button>
            </div>
        </div>
        <div class="icon_area">

        </div>
        <div class="submit_button">
            <button class="plastic ctrl">초기화</button>
            <button type="submit" class="plastic ctrl">추가</button>
        </div>
    </div>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
        let iconArea = document.querySelector('.icon_area');
        let can = document.getElementById('can');
        let bottle = document.getElementById('bottle');
        let bag = document.getElementById('bag');
        let cup = document.getElementById('cup');
        let snack = document.getElementById('snack');

        can.addEventListener('click', () => {
            let canImg = document.createElement('img');
            canImg.setAttribute('src', 'open-can.png');
            canImg.style.width = '50px';
            canImg.style.height = '50px';
            iconArea.appendChild(canImg);
        });

        bottle.addEventListener('click', () => {
            let bottleImg = document.createElement('img');
            bottleImg.setAttribute('src', 'water.png');
            bottleImg.style.width = '50px';
            bottleImg.style.height = '50px';
            iconArea.appendChild(bottleImg);
        });

        bag.addEventListener('click', () => {
            let bagImg = document.createElement('img');
            bagImg.setAttribute('src', 'bag.png');
            bagImg.style.width = '50px';
            bagImg.style.height = '50px';
            iconArea.appendChild(bagImg);
        });

        cup.addEventListener('click', () => {
            let cupImg = document.createElement('img');
            cupImg.setAttribute('src', 'drink.png');
            cupImg.style.width = '50px';
            cupImg.style.height = '50px';
            iconArea.appendChild(cupImg);
        });

        snack.addEventListener('click', () => {
            let snackImg = document.createElement('img');
            snackImg.setAttribute('src', 'snack.png');
            snackImg.style.width = '50px';
            snackImg.style.height = '50px';
            iconArea.appendChild(snackImg);
        });

        let deleteButton = document.querySelectorAll('.deleteButton');
        deleteButton.forEach(btn => {
            let id = btn.parentElement.id;
            btn.addEventListener('click', async () => {
                window.location.href=window.location.href
                await axios.delete(`/delete/${id}`, {
                    headers: {
                        'Content-Type': "application/json",
                    }
                });
            });
        });
    </script>
</body>
</html>


<% contents.forEach(content => { %> 
    <% if(userId === content.creater) { %> 
        <div id="<%= content._id %>">
            <a href="/<%= content._id %>"><%= content.title %></a>
            <button><a href="/edit/<%= content._id %>">수정</a></button>
            <button class="deleteButton">삭제</button>
        </div>
    <% } else { %> 
        <div id="<%= content._id %>">
            <a href="/<%= content._id %>"><%= content.title %></a>
        </div>
    <% } %> 
<% }) %> 
<button><a href="/create">글 작성</a></button>